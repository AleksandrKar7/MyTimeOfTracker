@using TimeOffTracker.Models;
@model PagesInfo

    <div class="btn-default">
        @using (Ajax.BeginForm("GetPartOfUsers"
            , new AjaxOptions { UpdateTargetId = "results", InsertionMode = InsertionMode.InsertAfter, HttpMethod = "Get" 
            , OnSuccess = "OnComplete(" + (Model.CurrentPage + 1).ToString() + ", " + Model.CountUsersInPage.ToString() + ")"}))
        {
            <input id="page" type="hidden" value=@((Model.CurrentPage + 1).ToString()) name="page" />
            <input type="hidden" value=@((Model.CountUsersInPage).ToString()) name="count" />

            <input id="next" class="center-block" type="submit" value="Show more" />
        }
    </div>
<nav aria-label="Page navigation example">
    <ul class="pagination">
        @*Кнопка назад*@
        @if (Model.CurrentPage > 1)
        {
            <li class="page-item">
                @Ajax.ActionLink("Previous", "GetPartOfUsers", new { page = (Model.CurrentPage - 1), count = Model.CountUsersInPage }
            , new AjaxOptions
            {
                UpdateTargetId = "results",
                InsertionMode = InsertionMode.Replace,
                HttpMethod = "Get",
                OnSuccess = "OnComplete(" + (Model.CurrentPage - 1).ToString() + ", " + Model.CountUsersInPage.ToString() + ")"
            })
            </li>
        }
        else
        {
            <li class="page-item disabled">
                <a class="page-link" href="#">Previous</a>
            </li>
        }

        @*Возврат к первой странице и ...*@
        @if (Model.CurrentPage > 3)
        {
            <li class="page-item">
                @Ajax.ActionLink("1", "GetPartOfUsers", new { page = 1, count = Model.CountUsersInPage }
           , new AjaxOptions
                {
                    UpdateTargetId = "results",
                    InsertionMode = InsertionMode.Replace,
                    HttpMethod = "Get",
                    OnSuccess = "OnComplete(" + (1).ToString() + ", " + Model.CountUsersInPage.ToString() + ")"
                })
            </li>
            <li class="page-item disabled">
                <a class="page-link" href="#">...</a>
                @*@Ajax.ActionLink("...", "GetPartOfUsers", new AjaxOptions { UpdateTargetId = "results", InsertionMode = InsertionMode.Replace, HttpMethod = "Get" })*@
            </li>
        }

        @*Теущая страница и две по бокам*@
        @for (int i = Model.CurrentPage - 2; i <= Model.CurrentPage + 2; i++)
        {
            if (i >= 1 && i <= Model.TotalPages)
            {
                @*Текущая страница*@
                if (i == Model.CurrentPage)
                {
                    <li class="page-item active">
                        @Ajax.ActionLink((i).ToString(), "GetPartOfUsers", new { page = i, count = Model.CountUsersInPage }
                   , new AjaxOptions
                        {
                            UpdateTargetId = "results",
                            InsertionMode = InsertionMode.Replace,
                            HttpMethod = "Get",
                            OnSuccess = "OnComplete(" + (i).ToString() + ", " + Model.CountUsersInPage.ToString() + ")"
                        })
                    </li>
                }
                @*Страницы по бокам*@
                else
                {
                    <li class="page-item">
                        @Ajax.ActionLink((i).ToString(), "GetPartOfUsers", new { page = i, count = Model.CountUsersInPage }
                   , new AjaxOptions
                        {
                            UpdateTargetId = "results",
                            InsertionMode = InsertionMode.Replace,
                            HttpMethod = "Get",
                            OnSuccess = "OnComplete(" + (i).ToString() + ", " + Model.CountUsersInPage.ToString() + ")"
                        })
                    </li>
                }
            }
        }

        @*... и последняя страница*@
        @if (Model.CurrentPage < Model.TotalPages - 2)
        {
            <li class="page-item disabled">
                <a class="page-link" href="#">...</a>
                @*@Ajax.ActionLink("...", "GetPartOfUsers", new AjaxOptions { UpdateTargetId = "results", InsertionMode = InsertionMode.Replace, HttpMethod = "Get" })*@
            </li>
            <li class="page-item">
                @Ajax.ActionLink((Model.TotalPages).ToString(), "GetPartOfUsers", new { page = Model.TotalPages - 2, count = Model.CountUsersInPage }
           , new AjaxOptions
                {
                    UpdateTargetId = "results",
                    InsertionMode = InsertionMode.Replace,
                    HttpMethod = "Get",
                    OnSuccess = "OnComplete(" + (Model.TotalPages).ToString() + ", " + Model.CountUsersInPage.ToString() + ")"
                })
            </li>
        }

        @if (Model.CurrentPage < Model.TotalPages)
        {
            <li class="page-item">
                @Ajax.ActionLink("Next", "GetPartOfUsers", new { page = (Model.CurrentPage + 1), count = Model.CountUsersInPage }
            , new AjaxOptions
            {
                UpdateTargetId = "results",
                InsertionMode = InsertionMode.Replace,
                HttpMethod = "Get",
                OnSuccess = "OnComplete(" + (Model.CurrentPage + 1).ToString() + ", " + Model.CountUsersInPage.ToString() + ")"
            })
            </li>
        }
        else
        {
            <li class="page-item disabled">
                <a class="page-link" href="#">Next</a>
            </li>
        }
    </ul>
</nav>
